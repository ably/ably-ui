import{j as e}from"./jsx-runtime-CZ2sIMGp.js";import{r as a}from"./iframe-uAgQpGx3.js";import{I as D}from"./Icon-CQE5WZJ9.js";import{c as b}from"./cn-Dw6GJglA.js";import{L as K}from"./Logo-CWFyQAPR.js";import{H as M,c as U,a as X}from"./heights-CjR9PzPP.js";import{L as C}from"./LinkButton-Bq4obVjI.js";import{D as R}from"./DropdownMenu-BBbwEOHV.js";import{C as Y}from"./component-CdDaL9tg.js";import{t as J}from"./throttle-BORCkuMQ.js";const Q={signedIn:!1,logOut:{token:"0000",href:"accounts/sign_out"},accountName:"Ably"},E=({sessionState:r=Q,headerLinks:v,searchButtonVisibility:y,searchButton:u,className:o})=>{const{signedIn:m,logOut:l}=r,N=a.useRef(null),f="font-sans !text-label2 md:!text-label3 font-bold py-4 text-neutral-1300 dark:text-neutral-000 md:text-neutral-1000 dark:md:text-neutral-300 hover:text-neutral-1300 dark:hover:text-neutral-000 active:text-neutral-1300 dark:active:text-neutral-000 transition-colors",d="block p-2 ui-text-label3 font-semibold text-neutral-1000 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-1200 active:bg-neutral-200 dark:active:bg-neutral-1100 rounded-lg",p=n=>{n.preventDefault(),N.current?.submit()},h=({className:n})=>a.useMemo(()=>e.jsx("a",{href:"/dashboard",className:n,children:"Dashboard"}),[n]),k=e.jsxs("form",{ref:N,method:"post",action:l.href,className:"hidden",children:[e.jsx("input",{name:"_method",value:"delete",type:"hidden"}),e.jsx("input",{name:"authenticity_token",value:l.token,type:"hidden"})]});return e.jsxs("nav",{className:b("flex md:flex-1 md:items-center md:justify-end flex-col md:flex-row border-t-[1px] border-neutral-300 md:border-t-0 md:gap-4 pt-3 pb-4 md:py-0",o),children:[m&&e.jsxs(e.Fragment,{children:[k,e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"flex flex-col border-b-[1px] border-neutral-300 px-4 pb-3 mb-3",children:[e.jsx("span",{className:"py-3 ui-text-sub-header text-[18px] text-neutral-700 dark:text-neutral-600 font-bold",children:r.accountName}),e.jsx(h,{className:f})]})})]}),v?.map(({href:n,label:t,external:c})=>e.jsxs("a",{className:b(f,"flex items-center gap-1.5 px-4 md:px-0 leading-none"),href:n,target:c?"_blank":void 0,rel:c?"noreferrer noopener":void 0,children:[t,c&&e.jsx(D,{name:"icon-gui-arrow-top-right-on-square-mini",size:"20px"})]},n)),y!=="mobile"?u:null,m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block relative",children:e.jsxs(R,{children:[e.jsx(R.Trigger,{description:`Account menu for ${r.accountName}`,children:e.jsx("span",{className:"block text-ellipsis overflow-hidden whitespace-nowrap w-full max-w-[9.375rem] leading-normal",children:r.accountName})}),e.jsx(R.Content,{anchorPosition:"right",contentClassNames:"w-60 mt-3",children:e.jsxs("div",{className:"p-2",children:[e.jsx(h,{className:d}),e.jsx("button",{onClick:p,className:d,children:"Logout"})]})})]})}),e.jsx("div",{className:"block md:hidden px-4 pt-4 pb-0",children:e.jsx(C,{onClick:p,variant:"secondary",className:"w-full md:ui-button-secondary-xs","aria-label":"Logout",rightIcon:"icon-gui-arrow-right-end-on-rectangle-outline",children:"Logout"})})]}):e.jsxs("div",{className:"flex gap-3 pt-3 md:py-0 px-4 md:px-0",children:[e.jsx(C,{href:"/login",variant:"secondary",className:"flex-1 md:flex-none md:ui-button-secondary-xs hover:text-neutral-1300 dark:hover:text-neutral-000",children:"Login"}),e.jsx(C,{href:"/sign-up",variant:"primary",className:"flex-1 md:flex-none md:ui-button-primary-xs hover:text-neutral-000 dark:hover:text-neutral-1300",children:"Start free"})]})]})};try{E.displayName="HeaderLinks",E.__docgenInfo={description:"",displayName:"HeaderLinks",props:{className:{defaultValue:null,description:"Optional classnames to add to the header",name:"className",required:!1,type:{name:"string"}},searchButton:{defaultValue:null,description:"Optional search button element.",name:"searchButton",required:!1,type:{name:"ReactNode"}},headerLinks:{defaultValue:null,description:"Array of header links.",name:"headerLinks",required:!1,type:{name:"{ href: string; label: string; external?: boolean; }[]"}},sessionState:{defaultValue:{value:`{
  signedIn: false,
  logOut: {
    token: "0000",
    href: "accounts/sign_out",
  },
  accountName: "Ably",
}`},description:"State of the user session.",name:"sessionState",required:!1,type:{name:"HeaderSessionState"}},searchButtonVisibility:{defaultValue:null,description:`Visibility setting for the search button.
- "all": Visible on all devices.
- "desktop": Visible only on desktop devices.
- "mobile": Visible only on mobile devices.`,name:"searchButtonVisibility",required:!1,type:{name:"enum",value:[{value:'"all"'},{value:'"desktop"'},{value:'"mobile"'}]}}}}}catch{}const H=64;function Z(r){const[v,y]=a.useState(""),u=a.useRef(""),o=a.useRef(null),m=a.useRef(!1),l=a.useRef(null),N=a.useRef(new Map);return a.useEffect(()=>{if(r.length===0){y(""),u.current="";return}let f=!0;const d=N.current,p=(n=!1)=>{let t=null;for(const[c,i]of d){const x=r.findIndex(L=>L.id===c);if(x===-1)continue;const w=r[x],j=n?i.boundingClientRect??i.target.getBoundingClientRect():i.target.getBoundingClientRect();if(j.top>H)continue;const g=Math.abs(j.top-H);(!t||g<t.distance||g===t.distance&&x<t.index)&&(t={scrollpoint:w,distance:g,index:x})}t&&t.scrollpoint.className!==u.current&&(u.current=t.scrollpoint.className,y(t.scrollpoint.className))};o.current=new IntersectionObserver(n=>{for(const t of n){const c=t.target.id;t.isIntersecting?d.set(c,t):d.delete(c)}l.current!==null&&cancelAnimationFrame(l.current),l.current=requestAnimationFrame(()=>{l.current=null,f&&p(!0)})},{rootMargin:`-${H}px 0px 0px 0px`,threshold:0});const h=()=>{l.current!==null&&cancelAnimationFrame(l.current),l.current=requestAnimationFrame(()=>{l.current=null,f&&p(!1)})};window.addEventListener("scroll",h,{passive:!0}),r.forEach(({id:n})=>{const t=document.getElementById(n);t?o.current?.observe(t):console.warn(`useThemedScrollpoints: Element with id "${n}" not found in DOM`)});const k=setTimeout(()=>{if(!m.current){m.current=!0;for(const n of r){const t=document.getElementById(n.id);t&&d.set(n.id,{target:t})}p(!1)}},0);return()=>{f=!1,clearTimeout(k),window.removeEventListener("scroll",h),l.current!==null&&(cancelAnimationFrame(l.current),l.current=null),o.current?.disconnect(),o.current=null,m.current=!1,d.clear()}},[r]),v}const q="hidden md:flex flex-1 items-center h-full",ee="560px",T=({className:r,isNoticeBannerEnabled:v=!1,noticeHeight:y=0,searchBar:u,searchButton:o,logoHref:m,headerLinks:l,headerLinksClassName:N,headerCenterClassName:f,nav:d,mobileNav:p,sessionState:h,themedScrollpoints:k=[],searchButtonVisibility:n="all",location:t,logoBadge:c})=>{const[i,x]=a.useState(!1),[w,j]=a.useState(!1),[g,L]=a.useState(v),F=a.useRef(null),z=Z(k),G={height:M,top:g?`${y}px`:"0"},$=b("fixed left-0 top-0 w-full z-50 bg-neutral-000 dark:bg-neutral-1300 border-b border-neutral-300 dark:border-neutral-1000 transition-all duration-300 ease-in-out px-6 lg:px-16",z,{"md:top-auto":g}),_=()=>{j(!0),setTimeout(()=>{x(!1),j(!1)},150)},V=a.useCallback(()=>{L(!1)},[]);a.useEffect(()=>(document.addEventListener("notice-closed",V),()=>document.removeEventListener("notice-closed",V)),[V]),a.useEffect(()=>{if(!v)return;const s=document.querySelector('[data-id="ui-notice"]');if(!s){console.warn("Header: Notice element not found");return}let O=g;const B=()=>{const P=window.scrollY,W=s.classList.contains("ui-announcement-hidden"),S=P<=Y&&!W;S!==O&&(O=S,L(S))},A=J(B,100);return B(),window.addEventListener("scroll",A,{passive:!0}),()=>{window.removeEventListener("scroll",A)}},[v,g]),a.useEffect(()=>{const s=()=>{window.innerWidth>=1040&&x(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),a.useEffect(()=>(i?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden"),()=>{document.body.classList.remove("overflow-hidden")}),[i]),a.useEffect(()=>{t&&i&&_()},[t]);const I=a.useMemo(()=>o?e.jsx("div",{className:"text-neutral-1300 dark:text-neutral-000 flex items-center",children:o}):null,[o]);return e.jsxs(e.Fragment,{children:[e.jsx("header",{role:"banner",style:G,className:$,children:e.jsxs("div",{className:b("flex items-center h-full",r),children:[e.jsxs("nav",{className:"flex flex-1 h-full items-center",children:[["light","dark"].map(s=>e.jsx(K,{href:m,theme:s,badge:c,additionalLinkAttrs:{className:b("h-full focus-base rounded mr-4 lg:mr-8",{"flex dark:hidden":s==="light","hidden dark:flex":s==="dark"})}},s)),e.jsx("div",{className:q,children:d})]}),e.jsxs("div",{className:"flex md:hidden flex-1 items-center justify-end gap-6 h-full",children:[n!=="desktop"?I:null,e.jsx("button",{className:"cursor-pointer focus-base rounded flex items-center p-0",onClick:()=>x(!i),"aria-expanded":i,"aria-controls":"mobile-menu","aria-label":"Toggle menu",children:e.jsx(D,{name:i?"icon-gui-x-mark-outline":"icon-gui-bars-3-outline",additionalCSS:"text-neutral-1300 dark:text-neutral-000",size:"1.5rem"})})]}),u?e.jsx("div",{className:b(q,"justify-center",f),children:u}):null,e.jsx(E,{className:b(q,N),headerLinks:l,sessionState:h,searchButton:I,searchButtonVisibility:n})]})}),i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:b("fixed inset-0 bg-neutral-1300 dark:bg-neutral-1300 z-40",{"animate-[fade-in-ten-percent_150ms_ease-in-out_forwards]":!w,"animate-[fade-out-ten-percent_150ms_ease-in-out_forwards]":w}),onClick:_,onKeyDown:s=>s.key==="Escape"&&_(),role:"presentation"}),e.jsxs("div",{id:"mobile-menu",className:"md:hidden fixed flex flex-col top-[4.75rem] overflow-y-hidden mx-3 right-0 w-[calc(100%-24px)] bg-neutral-000 dark:bg-neutral-1300 rounded-2xl ui-shadow-lg-medium z-50",style:{maxWidth:ee,maxHeight:U(M,X)},ref:F,role:"navigation",children:[p,e.jsx(E,{headerLinks:l,sessionState:h})]})]}):null]})};try{T.displayName="Header",T.__docgenInfo={description:"",displayName:"Header",props:{className:{defaultValue:null,description:"Optional classnames to add to the header",name:"className",required:!1,type:{name:"string"}},isNoticeBannerEnabled:{defaultValue:{value:"false"},description:"Indicates if the notice banner is enabled.",name:"isNoticeBannerEnabled",required:!1,type:{name:"boolean"}},noticeHeight:{defaultValue:{value:"0"},description:"Height of the notice banner in pixels.",name:"noticeHeight",required:!1,type:{name:"number"}},searchBar:{defaultValue:null,description:"Optional search bar element.",name:"searchBar",required:!1,type:{name:"ReactNode"}},searchButton:{defaultValue:null,description:"Optional search button element.",name:"searchButton",required:!1,type:{name:"ReactNode"}},logoHref:{defaultValue:null,description:"URL for the logo link.",name:"logoHref",required:!1,type:{name:"string"}},headerLinks:{defaultValue:null,description:"Array of header links.",name:"headerLinks",required:!1,type:{name:"{ href: string; label: string; external?: boolean; }[]"}},headerLinksClassName:{defaultValue:null,description:"Optional classname for styling the header links container.",name:"headerLinksClassName",required:!1,type:{name:"string"}},headerCenterClassName:{defaultValue:null,description:"Optional classname for styling the header center container.",name:"headerCenterClassName",required:!1,type:{name:"string"}},nav:{defaultValue:null,description:"Optional desktop navigation element.",name:"nav",required:!1,type:{name:"ReactNode"}},mobileNav:{defaultValue:null,description:"Optional mobile navigation element.",name:"mobileNav",required:!1,type:{name:"ReactNode"}},sessionState:{defaultValue:null,description:"State of the user session.",name:"sessionState",required:!1,type:{name:"HeaderSessionState"}},themedScrollpoints:{defaultValue:{value:"[]"},description:"Array of themed scrollpoints. The header will change its appearance based on the scrollpoint in view.",name:"themedScrollpoints",required:!1,type:{name:"ThemedScrollpoint[]"}},searchButtonVisibility:{defaultValue:{value:"all"},description:`Visibility setting for the search button.
- "all": Visible on all devices.
- "desktop": Visible only on desktop devices.
- "mobile": Visible only on mobile devices.`,name:"searchButtonVisibility",required:!1,type:{name:"enum",value:[{value:'"all"'},{value:'"desktop"'},{value:'"mobile"'}]}},location:{defaultValue:null,description:"Optional location object to detect location changes.",name:"location",required:!1,type:{name:"Location"}},logoBadge:{defaultValue:null,description:"Optional badge text to display on the logo.",name:"logoBadge",required:!1,type:{name:"string"}}}}}catch{}export{T as H};
