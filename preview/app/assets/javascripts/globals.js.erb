//  Module script files need to come before components because they assign an object to the module
//
//= require ably_ui/core/scripts
//= require ably_ui/core/meganav/component
//= require ably_ui/core/meganav_blog_posts_list/component
//= require ably_ui/core/contact_footer/component

/* global AblyUi */

document.addEventListener("DOMContentLoaded", () => {
  // Note this code is not transpiled and assumes browser support for spread syntax
  const store = AblyUi.Core.createRemoteDataStore({ ...AblyUi.Core.reducerBlogPosts, ...AblyUi.Core.reducerSessionData });
  AblyUi.Core.attachStoreToWindow(store);

  // Inserts a sprite map for <use> tags
  AblyUi.Core.loadSprites("<%= asset_path('ably_ui/core/sprites.svg') %>");

  // Components could be initialized here but because we serve a page per component they are initialized on particular pages

  // Fetch additional data, trigger a re-render for components subscribed to store
  AblyUi.Core.fetchBlogPosts(store, "/api/blog");
});
