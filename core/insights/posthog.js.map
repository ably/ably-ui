{"version":3,"sources":["../../../src/core/insights/posthog.ts"],"sourcesContent":["import posthog from \"posthog-js\";\n\nimport { InsightsIdentity } from \"./types\";\n\nexport const initPosthog = (apiKey: string, apiHost: string) => {\n  posthog.init(apiKey, {\n    api_host: apiHost,\n    capture_pageview: false,\n  });\n};\n\nexport const enableDebugMode = () => {\n  posthog.debug();\n};\n\nexport const disableDebugMode = () => {\n  posthog.debug(false);\n};\n\nexport const identify = ({\n  userId,\n  accountId,\n  organisationId,\n  email,\n  name,\n  ...properties\n}: InsightsIdentity) => {\n  // In very rare cases we might have a user without an account, so we'll\n  // let null/undefined/blank strings through on that one\n  if (!userId) {\n    return;\n  }\n\n  if (userId !== posthog.get_distinct_id()) {\n    posthog.identify(userId, { email, name, ...properties });\n  }\n\n  // Associate all events in this session with this account\n  if (accountId) {\n    posthog.group(\"account\", accountId);\n  }\n\n  // Associate all events in this session with this organisation (if available)\n  if (organisationId) {\n    posthog.group(\"organisation\", organisationId);\n  }\n};\n\nexport const trackPageView = (properties?: Record<string, unknown>) => {\n  posthog.capture(\"$pageview\", properties);\n};\n\nexport const track = (event: string, properties?: Record<string, unknown>) => {\n  posthog.capture(event, properties);\n};\n\nexport const startSessionRecording = () => {\n  posthog.startSessionRecording();\n};\n\nexport const stopSessionRecording = () => {\n  posthog.stopSessionRecording();\n};\n"],"names":["posthog","initPosthog","apiKey","apiHost","init","api_host","capture_pageview","enableDebugMode","debug","disableDebugMode","identify","userId","accountId","organisationId","email","name","properties","get_distinct_id","group","trackPageView","capture","track","event","startSessionRecording","stopSessionRecording"],"mappings":"AAAA,OAAOA,YAAa,YAAa,AAIjC,QAAO,MAAMC,YAAc,CAACC,OAAgBC,WAC1CH,QAAQI,IAAI,CAACF,OAAQ,CACnBG,SAAUF,QACVG,iBAAkB,KACpB,EACF,CAAE,AAEF,QAAO,MAAMC,gBAAkB,KAC7BP,QAAQQ,KAAK,EACf,CAAE,AAEF,QAAO,MAAMC,iBAAmB,KAC9BT,QAAQQ,KAAK,CAAC,MAChB,CAAE,AAEF,QAAO,MAAME,SAAW,CAAC,CACvBC,MAAM,CACNC,SAAS,CACTC,cAAc,CACdC,KAAK,CACLC,IAAI,CACJ,GAAGC,WACc,IAGjB,GAAI,CAACL,OAAQ,CACX,MACF,CAEA,GAAIA,SAAWX,QAAQiB,eAAe,GAAI,CACxCjB,QAAQU,QAAQ,CAACC,OAAQ,CAAEG,MAAOC,KAAM,GAAGC,UAAU,AAAC,EACxD,CAGA,GAAIJ,UAAW,CACbZ,QAAQkB,KAAK,CAAC,UAAWN,UAC3B,CAGA,GAAIC,eAAgB,CAClBb,QAAQkB,KAAK,CAAC,eAAgBL,eAChC,CACF,CAAE,AAEF,QAAO,MAAMM,cAAgB,AAACH,aAC5BhB,QAAQoB,OAAO,CAAC,YAAaJ,WAC/B,CAAE,AAEF,QAAO,MAAMK,MAAQ,CAACC,MAAeN,cACnChB,QAAQoB,OAAO,CAACE,MAAON,WACzB,CAAE,AAEF,QAAO,MAAMO,sBAAwB,KACnCvB,QAAQuB,qBAAqB,EAC/B,CAAE,AAEF,QAAO,MAAMC,qBAAuB,KAClCxB,QAAQwB,oBAAoB,EAC9B,CAAE"}