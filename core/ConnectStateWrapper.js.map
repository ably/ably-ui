{"version":3,"sources":["../../src/core/ConnectStateWrapper.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport { connectState, getRemoteDataStore } from \"./remote-data-store\";\n\n/*\n  Connect a react component to a global store.\n  This is similar to what react-redux does but uses our global store so\n  can share state with other React mount points or anything that uses the\n  store.\n  - selectors is an object where keys are your prop names and values are your select\n  functions that work on the store to retrieve the state you are interested in\n  - initial state is set in useEffect so the wrapped component needs to handle it's props set to undefined initially\n*/\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst ConnectStateWrapper = (Component: any, selectors: any) => {\n  const [state, setState] = useState({});\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const setStateForKey = (key: string) => (storeState: any) =>\n    setState(() => ({ [key]: storeState }));\n\n  useEffect(() => {\n    const store = getRemoteDataStore();\n    const resolvedState = Object.keys(selectors).reduce(\n      (acc, key) => ({ ...acc, [key]: selectors[key](store) }),\n      {},\n    );\n\n    // Set initial state\n    setState(resolvedState);\n\n    // Create a store subscription for each selector. Depending on your use case, this can be inefficient.\n    // When optimising for renders, look for wins with selectors better for your use and using connectState directly.\n    Object.keys(selectors).forEach((key) => {\n      connectState(selectors[key], setStateForKey(key));\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const WrappedComponent = (props: any) => <Component {...props} {...state} />;\n\n  return WrappedComponent;\n};\n\nexport default ConnectStateWrapper;\n"],"names":["React","useEffect","useState","connectState","getRemoteDataStore","ConnectStateWrapper","Component","selectors","state","setState","setStateForKey","key","storeState","store","resolvedState","Object","keys","reduce","acc","forEach","WrappedComponent","props"],"mappings":"AAAA,OAAOA,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAQ,AAEnD,QAASC,YAAY,CAAEC,kBAAkB,KAAQ,qBAAsB,CAavE,MAAMC,oBAAsB,CAACC,UAAgBC,aAC3C,KAAM,CAACC,MAAOC,SAAS,CAAGP,SAAS,CAAC,GAGpC,MAAMQ,eAAiB,AAACC,KAAgB,AAACC,YACvCH,SAAS,IAAO,CAAA,CAAE,CAACE,IAAI,CAAEC,UAAW,CAAA,GAEtCX,UAAU,KACR,MAAMY,MAAQT,qBACd,MAAMU,cAAgBC,OAAOC,IAAI,CAACT,WAAWU,MAAM,CACjD,CAACC,IAAKP,MAAS,CAAA,CAAE,GAAGO,GAAG,CAAE,CAACP,IAAI,CAAEJ,SAAS,CAACI,IAAI,CAACE,MAAO,CAAA,EACtD,CAAC,GAIHJ,SAASK,eAITC,OAAOC,IAAI,CAACT,WAAWY,OAAO,CAAC,AAACR,MAC9BR,aAAaI,SAAS,CAACI,IAAI,CAAED,eAAeC,KAC9C,EAEF,EAAG,EAAE,EAGL,MAAMS,iBAAmB,AAACC,OAAe,oBAACf,WAAW,GAAGe,KAAK,CAAG,GAAGb,KAAK,GAExE,OAAOY,gBACT,CAEA,gBAAef,mBAAoB"}